(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{85675:(e,t,s)=>{Promise.resolve().then(s.bind(s,16266))},16266:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>C,dynamic:()=>k});var r=s(95155),a=s(12115),i=s(76046),l=s(39556),n=s(2293),d=s(98217),o=s(21567);let c=d.bL,u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.B8,{ref:t,className:(0,o.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});u.displayName=d.B8.displayName;let m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.l9,{ref:t,className:(0,o.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});m.displayName=d.l9.displayName;let p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.UC,{ref:t,className:(0,o.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});p.displayName=d.UC.displayName;var f=s(22130),h=s(73312),x=s(33900),v=s(98986);let g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});g.displayName="Textarea";var _=s(30814),j=s(54208);let b=(0,n.b)();function y(e){let{svId:t,onChanged:s}=e,[i,l]=(0,a.useState)([]),[n,d]=(0,a.useState)({});async function o(e,r){let a={...n,[e]:r};d(a),await b.from("site_visit_checklist_response").upsert({site_visit_id:t,checklist_item_code:e,response_option_code:r}),null==s||s(a)}return(0,a.useEffect)(()=>{(async()=>{let[{data:e},{data:r}]=await Promise.all([b.from("checklist_item").select("code,label").eq("is_active",!0),b.from("site_visit_checklist_response").select("checklist_item_code,response_option_code").eq("site_visit_id",t)]);l(e||[]);let a={};(r||[]).forEach(e=>{a[e.checklist_item_code]=e.response_option_code}),d(a),null==s||s(a)})()},[t]),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:"Prep checklist"}),(0,r.jsx)("div",{className:"space-y-2",children:i.map(e=>(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 items-center",children:[(0,r.jsx)(v.J,{children:e.label}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("label",{className:"flex items-center gap-1 text-sm",children:[(0,r.jsx)("input",{type:"radio",name:e.code,checked:"yes"===n[e.code],onChange:()=>o(e.code,"yes")})," Yes"]}),(0,r.jsxs)("label",{className:"flex items-center gap-1 text-sm",children:[(0,r.jsx)("input",{type:"radio",name:e.code,checked:"no"===n[e.code],onChange:()=>o(e.code,"no")})," No"]}),(0,r.jsxs)("label",{className:"flex items-center gap-1 text-sm",children:[(0,r.jsx)("input",{type:"radio",name:e.code,checked:"na"===n[e.code],onChange:()=>o(e.code,"na")})," N/A"]})]})]},e.code))})]})}let w=(0,n.b)();function N(e){let{siteVisitId:t}=e,[s,i]=(0,a.useState)(""),[l,n]=(0,a.useState)(""),[d,o]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{let{data:e}=await w.from("site_visit_eba_snapshot").select("eba_id, document_url").eq("site_visit_id",t).maybeSingle();o(e),i((null==e?void 0:e.document_url)||""),n((null==e?void 0:e.eba_id)||"")})()},[t]);let c=async()=>{let{error:e}=await w.from("site_visit_eba_snapshot").upsert({site_visit_id:t,eba_id:l||null,document_url:s||null});if(e)return _.o.error(e.message);_.o.success("EBA link saved")};return(0,r.jsxs)("div",{className:"space-y-2 p-3 rounded border",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:"EBA quick attach"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"EBA record (optional)"}),(0,r.jsx)(x.p,{value:l,onChange:e=>n(e.target.value),placeholder:"company_eba_records.id"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Document URL"}),(0,r.jsx)(x.p,{value:s,onChange:e=>i(e.target.value),placeholder:"https://..."})]})]}),(0,r.jsx)(h.$,{onClick:c,size:"sm",children:"Save EBA link"})]})}let k="force-dynamic";function S(e,t){return"sv:".concat(e,":draft:").concat(t)}function C(){let e=(0,n.b)(),t=(0,i.useParams)(),s=(null==t?void 0:t.svCode)||"",[d,o]=(0,a.useState)("prep"),{data:b,refetch:w}=(0,l.I)({queryKey:["site-visit",s],enabled:!!s,queryFn:async()=>{let{data:t,error:r}=await e.from("site_visit").select("id, employer_id, job_site_id, objective, estimated_workers_count, outcomes_locked, status_code, scheduled_at, started_at, completed_at").eq("sv_code",s).maybeSingle();if(r)throw r;return t}}),[k,C]=(0,a.useState)(""),[D,R]=(0,a.useState)(""),[E,B]=(0,a.useState)(""),[O,A]=(0,a.useState)(!1),[I,J]=(0,a.useState)(!1),[q,Z]=(0,a.useState)({});(0,a.useEffect)(()=>{var e;b&&(C(b.objective||""),R(null!==(e=b.estimated_workers_count)&&void 0!==e?e:""),B(b.scheduled_at?new Date(b.scheduled_at).toISOString().slice(0,16):""))},[b]);let P=async()=>{var t;if(!b)return;if(E&&new Date(E).getTime()<Date.now()){_.o.error("Scheduled time must be in the future");return}let{error:r}=await e.from("site_visit").update({objective:k,estimated_workers_count:""===D?null:Number(D),scheduled_at:E?new Date(E).toISOString():null}).eq("id",b.id);if(r)return _.o.error(r.message);_.o.success("Saved"),t=S(s,"prep"),"undefined"!=typeof localStorage&&localStorage.removeItem(t)},W=async()=>{if(!b)return;A(!0);let{error:t}=await e.from("site_visit").update({status_code:"in_progress",started_at:new Date().toISOString()}).eq("id",b.id);if(A(!1),t)return _.o.error(t.message);_.o.success("Visit started"),w()},$=async()=>{if(!b)return;J(!0);let{error:t}=await e.from("site_visit").update({status_code:"completed",completed_at:new Date().toISOString(),outcomes_locked:!0}).eq("id",b.id);if(J(!1),t)return _.o.error(t.message);_.o.success("Visit completed"),w()},[U,F]=(0,a.useState)("3"),[L,z]=(0,a.useState)([]);(0,a.useEffect)(()=>{let{data:e}=function(e){try{let t="undefined"!=typeof localStorage?localStorage.getItem(e):null;if(!t)return{data:null};let s=JSON.parse(t);return{data:s.data,savedAt:s.savedAt}}catch(e){return{data:null}}}(S(s,"prep"));if(e){var t;C(e.objective||""),R(null!==(t=e.estimatedWorkers)&&void 0!==t?t:"")}},[s]),(0,a.useEffect)(()=>{var e,t;e=S(s,"prep"),t={objective:k,estimatedWorkers:D},"undefined"!=typeof localStorage&&localStorage.setItem(e,JSON.stringify({data:t,savedAt:Date.now()}))},[s,k,D]);let T=async()=>{if(!b)return;let{data:t,error:s}=await e.from("whs_assessment").upsert({site_visit_id:b.id,rating_code:U}).select("id").single();if(s)return _.o.error(s.message);for(let s of L){if(!s.title)continue;let{error:r}=await e.from("whs_breach").insert({whs_assessment_id:t.id,title:s.title,notes:s.notes||null,rating_code:U});if(r)return _.o.error(r.message)}_.o.success("WHS saved"),z([])},[V,H]=(0,a.useState)({super_paid:!0,super_paid_to_fund:!0,redundancy_contributions_up_to_date:!0,wages_correct:!0,eba_allowances_correct:!0}),M=async()=>{if(!b)return;let{error:t}=await e.from("entitlements_audit").upsert({site_visit_id:b.id,...V}).select("id").single();if(t)return _.o.error(t.message);_.o.success("Entitlements saved")},[K,Q]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(8),{data:G=[]}=(0,l.I)({queryKey:["delegate-role-types"],queryFn:async()=>{let{data:t,error:s}=await e.from("delegate_role_type").select("code,label");if(s)throw s;return t||[]}}),[ee,et]=(0,a.useState)({});(0,a.useEffect)(()=>{let e={};G.forEach(t=>{e[t.code]=e[t.code]||"3"}),et(t=>({...e,...t}))},[G]);let es=async()=>{if(!b)return;let{data:t,error:s}=await e.from("delegate_assessment").upsert({site_visit_id:b.id,present:K}).select("id").single();if(s)return _.o.error(s.message);for(let s of Object.keys(ee)){let r={role_type_code:s,rating_code:ee[s]};await e.from("delegate_role_rating").upsert({delegate_assessment_id:t.id,...r})}_.o.success("Delegate saved")},[er,ea]=(0,a.useState)(null),[ei,el]=(0,a.useState)("follow_up"),[en,ed]=(0,a.useState)(""),eo=async()=>{if(!b||!er)return;let t=crypto.randomUUID(),s={site_visit_id:b.id,worker_id:er,method_code:"in_person",outcome_code:ei,follow_up_at:"follow_up"===ei&&en?new Date(en).toISOString():null,client_generated_id:t};if("follow_up"===ei&&!en){_.o.error("Follow-up date/time required for follow-up outcome");return}let{error:r}=await e.from("dd_conversion_attempt").insert(s);if(r)return _.o.error(r.message);"converted"===ei&&confirm("Mark worker membership as Direct Debit active now?")&&await e.from("worker_memberships").upsert({worker_id:er,payment_method:"direct_debit",dd_status:"active"}),_.o.success("DD attempt saved"),ea(null)},ec=(0,a.useMemo)(()=>{let e=q||{},t=t=>"yes"===e[t]||"na"===e[t];return t("roe_email_sent")&&t("worker_list_updated")},[q]);return b?(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-4 text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{className:"mr-3",children:["Status: ",(0,r.jsx)("strong",{children:b.status_code||"draft_prep"})]}),b.scheduled_at&&(0,r.jsxs)("span",{className:"mr-3",children:["Scheduled: ",new Date(b.scheduled_at).toLocaleString()]}),b.started_at&&(0,r.jsxs)("span",{className:"mr-3",children:["Started: ",new Date(b.started_at).toLocaleString()]}),b.completed_at&&(0,r.jsxs)("span",{children:["Completed: ",new Date(b.completed_at).toLocaleString()]})]}),(0,r.jsxs)(c,{value:d,onValueChange:o,children:[(0,r.jsxs)(u,{children:[(0,r.jsx)(m,{value:"prep",children:"Prep"}),(0,r.jsx)(m,{value:"outcome",children:"Outcome"}),(0,r.jsx)(m,{value:"print",children:"Print"})]}),(0,r.jsx)(p,{value:"prep",children:(0,r.jsxs)(f.Zp,{children:[(0,r.jsx)(f.aR,{children:(0,r.jsx)(f.ZB,{children:"Preparation"})}),(0,r.jsxs)(f.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Objective"}),(0,r.jsx)(g,{value:k,onChange:e=>C(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Estimated workers"}),(0,r.jsx)(x.p,{type:"number",min:0,value:D,onChange:e=>R(""===e.target.value?"":Number(e.target.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Scheduled Date/Time"}),(0,r.jsx)(x.p,{type:"datetime-local",value:E,onChange:e=>B(e.target.value)})]})]}),(0,r.jsx)(y,{svId:b.id,onChanged:e=>Z(e)}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,r.jsx)(N,{siteVisitId:b.id})}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:gap-3",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(h.$,{onClick:P,disabled:!!b.outcomes_locked,children:"Save"}),(0,r.jsx)(h.$,{variant:"outline",onClick:W,disabled:!!b.outcomes_locked||"in_progress"===b.status_code||"completed"===b.status_code||O||!ec,children:"Start visit"}),(0,r.jsx)(h.$,{variant:"outline",onClick:$,disabled:!!b.outcomes_locked||"in_progress"!==b.status_code||I,children:"Complete visit"})]}),!ec&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:"Complete ROE email and worker list refresh before starting."})]})]})]})}),(0,r.jsx)(p,{value:"outcome",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(f.Zp,{children:[(0,r.jsx)(f.aR,{children:(0,r.jsx)(f.ZB,{children:"WHS"})}),(0,r.jsxs)(f.Wu,{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Overall rating (1 worst, 5 best)"}),(0,r.jsx)("select",{className:"border rounded h-10 w-full px-2",value:U,onChange:e=>F(e.target.value),children:["1","2","3","4","5"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{children:"Breaches"}),L.map((e,t)=>(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)(x.p,{placeholder:"Title",value:e.title,onChange:e=>z(s=>s.map((s,r)=>r===t?{...s,title:e.target.value}:s))}),(0,r.jsx)(x.p,{placeholder:"Notes",value:e.notes||"",onChange:e=>z(s=>s.map((s,r)=>r===t?{...s,notes:e.target.value}:s))})]},t)),(0,r.jsx)(h.$,{variant:"outline",onClick:()=>z(e=>[...e,{title:""}]),children:"Add breach"})]}),(0,r.jsx)(h.$,{onClick:T,disabled:!!b.outcomes_locked,children:"Save WHS"})]})]}),(0,r.jsxs)(f.Zp,{children:[(0,r.jsx)(f.aR,{children:(0,r.jsx)(f.ZB,{children:"Entitlements"})}),(0,r.jsxs)(f.Wu,{className:"space-y-2",children:[Object.entries(V).map(e=>{let[t,s]=e;return(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:s,onChange:e=>H(s=>({...s,[t]:e.target.checked}))}),(0,r.jsx)("span",{className:"capitalize",children:t.replace(/_/g," ")})]},t)}),(0,r.jsxs)("div",{className:"p-3 rounded border bg-muted/20 text-sm",children:[(0,r.jsx)("strong",{children:"CBUS checks"})," (placeholder): confirm super is paid, correct, and to CBUS. Attach evidence via Attachments."]}),(0,r.jsx)(h.$,{onClick:M,disabled:!!b.outcomes_locked,children:"Save Entitlements"})]})]}),(0,r.jsxs)(f.Zp,{children:[(0,r.jsx)(f.aR,{children:(0,r.jsx)(f.ZB,{children:"Delegate"})}),(0,r.jsxs)(f.Wu,{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:K,onChange:e=>Q(e.target.checked)}),(0,r.jsx)("span",{children:"Delegate present"})]}),(0,r.jsx)(v.J,{children:"Ratio score (10→1)"}),(0,r.jsx)(x.p,{type:"number",min:1,max:10,value:X,onChange:e=>Y(Number(e.target.value))}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Role capabilities"}),G.map(e=>(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 items-center",children:[(0,r.jsx)("div",{className:"text-sm",children:e.label}),(0,r.jsx)("select",{className:"border rounded h-10 w-full px-2",value:ee[e.code]||"3",onChange:t=>et(s=>({...s,[e.code]:t.target.value})),children:["1","2","3","4","5"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]},e.code))]}),(0,r.jsx)(h.$,{onClick:es,disabled:!!b.outcomes_locked,children:"Save Delegate"})]})]}),(0,r.jsxs)(f.Zp,{children:[(0,r.jsx)(f.aR,{children:(0,r.jsx)(f.ZB,{children:"Direct Debit"})}),(0,r.jsxs)(f.Wu,{className:"space-y-3",children:[(0,r.jsx)(j.M,{employerId:b.employer_id,value:er||"",onChange:e=>ea(e)}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Outcome"}),(0,r.jsxs)("select",{className:"border rounded h-10 w-full px-2",value:ei,onChange:e=>el(e.target.value),children:[(0,r.jsx)("option",{value:"converted",children:"Converted"}),(0,r.jsx)("option",{value:"already_on_dd",children:"Already on DD"}),(0,r.jsx)("option",{value:"follow_up",children:"Follow up"}),(0,r.jsx)("option",{value:"declined",children:"Declined"})]})]}),"follow_up"===ei&&(0,r.jsxs)("div",{children:[(0,r.jsx)(v.J,{children:"Follow up at"}),(0,r.jsx)(x.p,{type:"datetime-local",value:en,onChange:e=>ed(e.target.value)})]}),(0,r.jsx)(h.$,{onClick:eo,disabled:!er||!!b.outcomes_locked,children:"Save Attempt"})]})]})]})}),(0,r.jsx)(p,{value:"print",children:(0,r.jsx)(()=>(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)(f.Zp,{children:[(0,r.jsx)(f.aR,{children:(0,r.jsx)(f.ZB,{children:"Print Pack Preview"})}),(0,r.jsxs)(f.Wu,{children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"A4, 12.7mm margins. Use your browser Print. QR and sv_code shown on footer."}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(h.$,{onClick:()=>window.print(),children:"Print"})})]})]})}),{})})]})]}):(0,r.jsx)("div",{className:"p-6",children:"Loading..."})}},73312:(e,t,s)=>{"use strict";s.d(t,{$:()=>o});var r=s(95155),a=s(12115),i=s(12317),l=s(31027),n=s(21567);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,size:l,asChild:o=!1,...c}=e,u=o?i.DX:"button";return(0,r.jsx)(u,{className:(0,n.cn)(d({variant:a,size:l,className:s})),ref:t,...c})});o.displayName="Button"},22130:(e,t,s)=>{"use strict";s.d(t,{Wu:()=>o,ZB:()=>d,Zp:()=>l,aR:()=>n});var r=s(95155),a=s(12115),i=s(21567);let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});l.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});n.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});d.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})}).displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},33900:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var r=s(95155),a=s(12115),i=s(21567);let l=a.forwardRef((e,t)=>{let{className:s,type:a,...l}=e;return(0,r.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});l.displayName="Input"},98986:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var r=s(95155),a=s(12115),i=s(46195),l=s(31027),n=s(21567);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.b,{ref:t,className:(0,n.cn)(d(),s),...a})});o.displayName=i.b.displayName},54208:(e,t,s)=>{"use strict";s.d(t,{M:()=>d});var r=s(95155),a=s(12115),i=s(2293),l=s(98986);let n=(0,i.b)();function d(e){let{employerId:t,value:s,onChange:i}=e,[d,o]=(0,a.useState)([]),[c,u]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!t)return;u(!0);let{data:s,error:r}=await n.from("workers").select("id, first_name, surname, worker_placements!inner(employer_id)").eq("worker_placements.employer_id",t).limit(500);e||(r||o((s||[]).map(e=>({id:e.id,first_name:e.first_name,surname:e.surname}))),u(!1))})(),()=>{e=!0}},[t]),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.J,{children:"Worker"}),(0,r.jsxs)("select",{className:"border rounded h-10 w-full px-2",value:s||"",onChange:e=>i(e.target.value),disabled:c||!t,children:[(0,r.jsx)("option",{value:"",children:"Select worker"}),d.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.first_name," ",e.surname]},e.id))]})]})}},2293:(e,t,s)=>{"use strict";s.d(t,{b:()=>a});var r=s(51106);function a(){return(0,r.UU)("http://localhost","dev")}},21567:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var r=s(43463),a=s(69795);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[106,181,527,556,294,814,176,441,517,358],()=>t(85675)),_N_E=e.O()}]);